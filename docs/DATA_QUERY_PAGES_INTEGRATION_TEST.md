# 데이터생성 확인페이지 통합 테스트 가이드

**작성일**: 2025-01-28  
**테스트 범위**: 데이터생성 확인페이지 전체 기능 통합 테스트

---

## 테스트 환경 설정

### 필수 조건
1. Databricks 연결 설정 완료
2. `nh_ai.gold` 스키마에 테이블 존재 확인
3. 적절한 권한 (analyst, ops, admin)으로 로그인

---

## 테스트 시나리오

### 시나리오 1: AI 시황 결과 데이터 쿼리 - 기본 조회

**단계**:
1. 메뉴에서 "데이터 관리" > "AI 시황 결과 데이터 쿼리" 클릭
2. 페이지 로드 확인
3. 기본 쿼리 템플릿이 선택되어 있는지 확인
4. "쿼리 실행" 버튼 클릭
5. 결과 확인

**예상 결과**:
- ✅ 페이지가 정상적으로 로드됨
- ✅ 기본 쿼리가 표시됨
- ✅ 쿼리 실행 후 결과 테이블에 데이터 표시
- ✅ 실행 시간 및 행 수 표시

**검증 포인트**:
- [ ] 페이지 렌더링 시간 < 2초
- [ ] 쿼리 실행 시간 < 30초
- [ ] 결과 테이블에 컬럼명 정상 표시
- [ ] 결과 데이터 정상 표시

---

### 시나리오 2: AI 시황 결과 데이터 쿼리 - 조건 설정 조회

**단계**:
1. "날짜 범위 조회" 템플릿 선택
2. 시작 날짜: 2025-01-01
3. 종료 날짜: 2025-01-31
4. 결과 제한: 50
5. "조건 적용" 버튼 클릭
6. 쿼리가 조건에 맞게 수정되었는지 확인
7. "쿼리 실행" 버튼 클릭

**예상 결과**:
- ✅ 쿼리에 날짜 범위 조건이 추가됨
- ✅ LIMIT 50이 적용됨
- ✅ 해당 기간 데이터만 조회됨

**검증 포인트**:
- [ ] 날짜 범위가 쿼리에 정확히 반영됨
- [ ] LIMIT 값이 정확히 적용됨
- [ ] 결과가 날짜 범위 내 데이터만 포함

---

### 시나리오 3: AI 시황 결과 데이터 쿼리 - 키워드 검색

**단계**:
1. "키워드 검색" 템플릿 선택
2. 키워드: "금리"
3. 조회 기간: 30일
4. "조건 적용" 버튼 클릭
5. "쿼리 실행" 버튼 클릭

**예상 결과**:
- ✅ 쿼리에 키워드 검색 조건이 추가됨
- ✅ 제목 또는 내용에 "금리"가 포함된 데이터만 조회됨

**검증 포인트**:
- [ ] 키워드가 LIKE 조건에 정확히 반영됨
- [ ] 검색 결과가 키워드를 포함하는 데이터만 포함

---

### 시나리오 4: 잔고 분석 결과 데이터 쿼리 - 기본 조회

**단계**:
1. 메뉴에서 "데이터 관리" > "잔고 분석 결과 데이터 쿼리" 클릭
2. 페이지 로드 확인
3. 기본 쿼리 템플릿이 선택되어 있는지 확인
4. "쿼리 실행" 버튼 클릭
5. 결과 확인

**예상 결과**:
- ✅ 페이지가 정상적으로 로드됨
- ✅ 기본 쿼리가 표시됨
- ✅ 쿼리 실행 후 결과 테이블에 데이터 표시

**검증 포인트**:
- [ ] 페이지 렌더링 시간 < 2초
- [ ] 쿼리 실행 시간 < 30초
- [ ] 결과 테이블에 컬럼명 정상 표시
- [ ] JSON 필드 (top_holdings, sector_distribution) 정상 표시

---

### 시나리오 5: 잔고 분석 결과 데이터 쿼리 - 사용자별 조회

**단계**:
1. "사용자별 조회" 템플릿 선택
2. 사용자 ID 입력 (예: "user123")
3. "조건 적용" 버튼 클릭
4. "쿼리 실행" 버튼 클릭

**예상 결과**:
- ✅ 쿼리에 사용자 ID 조건이 추가됨
- ✅ 해당 사용자의 데이터만 조회됨

**검증 포인트**:
- [ ] 사용자 ID가 WHERE 조건에 정확히 반영됨
- [ ] 결과가 해당 사용자 데이터만 포함

---

### 시나리오 6: 잔고 분석 결과 데이터 쿼리 - 수익률 필터링

**단계**:
1. "수익률 필터" 템플릿 선택
2. 최소 수익률: 5%
3. "조건 적용" 버튼 클릭
4. "쿼리 실행" 버튼 클릭

**예상 결과**:
- ✅ 쿼리에 수익률 조건이 추가됨
- ✅ 5% 이상 수익 데이터만 조회됨

**검증 포인트**:
- [ ] 수익률 조건이 WHERE 절에 정확히 반영됨
- [ ] 결과가 5% 이상 수익 데이터만 포함

---

### 시나리오 7: CSV 내보내기

**단계**:
1. 쿼리 실행 후 결과 확인
2. "CSV 내보내기" 버튼 클릭
3. 파일 다운로드 확인
4. CSV 파일 열어서 내용 확인

**예상 결과**:
- ✅ CSV 파일이 다운로드됨
- ✅ 파일명에 날짜가 포함됨
- ✅ CSV 내용이 결과와 일치함

**검증 포인트**:
- [ ] 파일 다운로드 정상 동작
- [ ] CSV 헤더 정상
- [ ] CSV 데이터 정상
- [ ] JSON 필드가 문자열로 변환됨

---

### 시나리오 8: 쿼리 복사

**단계**:
1. 쿼리 입력
2. "복사" 버튼 클릭
3. 다른 곳에 붙여넣기

**예상 결과**:
- ✅ 쿼리가 클립보드에 복사됨
- ✅ 토스트 알림 표시
- ✅ 붙여넣기 시 쿼리 내용 정상

**검증 포인트**:
- [ ] 클립보드 복사 정상 동작
- [ ] 토스트 알림 표시
- [ ] 복사된 내용이 정확함

---

### 시나리오 9: 쿼리 히스토리

**단계**:
1. 여러 쿼리 실행
2. 쿼리 히스토리 확인
3. 히스토리에서 쿼리 선택

**예상 결과**:
- ✅ 실행한 쿼리가 히스토리에 저장됨
- ✅ 히스토리에서 쿼리 선택 시 쿼리 편집기에 로드됨

**검증 포인트**:
- [ ] 히스토리에 최대 10개 저장
- [ ] 히스토리 클릭 시 쿼리 로드
- [ ] 히스토리 스크롤 정상 동작

---

### 시나리오 10: 에러 처리

**단계**:
1. 잘못된 SQL 쿼리 입력 (예: SELECT * FROM nonexistent_table)
2. "쿼리 실행" 버튼 클릭

**예상 결과**:
- ✅ 에러 메시지 표시
- ✅ 토스트 알림 표시
- ✅ 결과 영역에 에러 표시

**검증 포인트**:
- [ ] 에러 메시지가 명확함
- [ ] 사용자 친화적인 에러 메시지
- [ ] 에러 후에도 페이지가 정상 동작

---

### 시나리오 11: 빈 쿼리 실행

**단계**:
1. 쿼리 편집기를 비움
2. "쿼리 실행" 버튼 클릭

**예상 결과**:
- ✅ 에러 메시지 표시
- ✅ 쿼리 실행되지 않음

**검증 포인트**:
- [ ] 빈 쿼리 검증 정상 동작
- [ ] 에러 메시지 명확함

---

### 시나리오 12: 권한 검증

**단계**:
1. user 역할로 로그인
2. 직접 URL 입력: `/data-query-ai-market`
3. 접근 시도

**예상 결과**:
- ✅ 접근 거부됨
- ✅ 권한 없음 메시지 표시 또는 리다이렉트

**검증 포인트**:
- [ ] ProtectedRoute 정상 동작
- [ ] 권한 없는 사용자 접근 차단

---

## 자동화 테스트 체크리스트

### 프론트엔드 테스트
- [ ] 페이지 컴포넌트 렌더링 테스트
- [ ] 쿼리 템플릿 선택 테스트
- [ ] 조건 적용 로직 테스트
- [ ] 쿼리 실행 API 호출 테스트
- [ ] 결과 표시 테스트
- [ ] CSV 내보내기 테스트
- [ ] 에러 처리 테스트

### 백엔드 테스트
- [ ] API 엔드포인트 응답 테스트
- [ ] SQL 쿼리 검증 테스트
- [ ] Databricks 연결 테스트
- [ ] 에러 처리 테스트
- [ ] 타임아웃 처리 테스트

### 통합 테스트
- [ ] 전체 플로우 테스트
- [ ] 권한 검증 테스트
- [ ] 성능 테스트
- [ ] 보안 테스트

---

## 발견된 이슈 및 해결 방안

### 이슈 없음

현재 코드 검토 결과, 발견된 이슈는 없습니다.

---

## 개선 제안

1. **쿼리 히스토리 영구 저장**: 로컬 스토리지 또는 서버에 저장
2. **쿼리 즐겨찾기**: 자주 사용하는 쿼리 저장
3. **쿼리 공유**: 다른 사용자와 쿼리 공유
4. **결과 차트 시각화**: 숫자 데이터 차트 표시
5. **쿼리 성능 분석**: 실행 시간 및 비용 분석
6. **자동완성**: SQL 키워드 및 테이블명 자동완성
7. **쿼리 검증**: 실행 전 SQL 구문 검증

---

**테스트 가이드 작성일**: 2025-01-28  
**최종 검토일**: 2025-01-28

